# Rollup Plugin DTS Merger 🚀

[![npm version](https://badge.fury.io/js/rollup-plugin-dts-merger.svg)](https://badge.fury.io/js/rollup-plugin-dts-merger)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

> A powerful Rollup plugin for merging TypeScript declaration files ✨

## 📋 Table of Contents

- [Features](#-features)
- [Installation](#-installation)
- [Usage](#-usage)
- [API Documentation](#-api-documentation)
- [Examples](#-examples)
- [Contributing](#-contributing)
- [License](#-license)

## ✨ Features

- 🔄 Merge multiple TypeScript declaration files into one
- 🎯 Configurable input/output paths
- 🔒 Option to include/exclude private declarations
- 📝 Custom header support
- 🚫 File exclusion patterns
- ⚡ Fast and efficient processing
- 🛠️ Easy integration with existing Rollup configurations

## 📦 Installation

```bash
# Using pnpm (recommended)
pnpm add -D rollup-plugin-dts-merger

# Using npm
npm install --save-dev rollup-plugin-dts-merger

# Using yarn
yarn add -D rollup-plugin-dts-merger
```

## 🚀 Usage

### Basic Usage

```javascript
import dtsMerger from 'rollup-plugin-dts-merger';

export default {
  input: 'src/index.ts',
  output: {
    file: 'dist/bundle.js',
    format: 'es',
  },
  plugins: [dtsMerger()],
};
```

### Advanced Configuration

```javascript
import dtsMerger from 'rollup-plugin-dts-merger';

export default {
  input: 'src/index.ts',
  output: {
    file: 'dist/bundle.js',
    format: 'es',
  },
  plugins: [
    dtsMerger({
      inputDir: 'src',
      outputFile: 'dist/types.d.ts',
      includePrivate: false,
      header: '// Auto-generated type definitions',
      exclude: ['**/*.test.d.ts', '**/internal/**'],
    }),
  ],
};
```

## 📚 API Documentation

### `dtsMerger(options?: DtsMergerOptions): Plugin`

Creates a Rollup plugin instance for merging TypeScript declaration files.

#### Parameters

- `options` (optional): Configuration options for the plugin

#### Returns

A Rollup plugin instance with the following hooks:

- `buildStart()`: Initializes the plugin
- `generateBundle()`: Processes and merges declaration files
- `writeBundle()`: Writes the merged declaration file

### `DtsMergerOptions`

Configuration interface for the dts-merger plugin.

#### Properties

| Property         | Type       | Default                                           | Description                                             |
| ---------------- | ---------- | ------------------------------------------------- | ------------------------------------------------------- |
| `inputDir`       | `string`   | `'src'`                                           | Input directory containing TypeScript declaration files |
| `outputFile`     | `string`   | `'dist/index.d.ts'`                               | Output file path for the merged declaration file        |
| `includePrivate` | `boolean`  | `false`                                           | Whether to include internal/private declarations        |
| `header`         | `string`   | `'// Auto-generated by rollup-plugin-dts-merger'` | Custom header to add to the merged file                 |
| `exclude`        | `string[]` | `['**/*.test.d.ts', '**/*.spec.d.ts']`            | File patterns to exclude from merging                   |

## 💡 Examples

### Example 1: Basic Library Setup

```javascript
// rollup.config.js
import dtsMerger from 'rollup-plugin-dts-merger';
import typescript from '@rollup/plugin-typescript';

export default {
  input: 'src/index.ts',
  output: [
    {
      file: 'dist/index.js',
      format: 'es',
    },
    {
      file: 'dist/index.cjs',
      format: 'cjs',
    },
  ],
  plugins: [
    typescript(),
    dtsMerger({
      outputFile: 'dist/index.d.ts',
    }),
  ],
};
```

### Example 2: Monorepo Package

```javascript
// packages/core/rollup.config.js
import dtsMerger from 'rollup-plugin-dts-merger';

export default {
  input: 'src/index.ts',
  output: {
    file: 'dist/core.js',
    format: 'es',
  },
  plugins: [
    dtsMerger({
      inputDir: 'src',
      outputFile: 'dist/core.d.ts',
      header: '// Core package type definitions',
      exclude: ['**/*.test.d.ts', '**/*.internal.d.ts'],
    }),
  ],
};
```

### Example 3: Custom Header and Exclusions

```javascript
import dtsMerger from 'rollup-plugin-dts-merger';

export default {
  // ... other config
  plugins: [
    dtsMerger({
      header: `/**
 * My Awesome Library
 * Generated on ${new Date().toISOString()}
 * @version 1.0.0
 */`,
      exclude: ['**/*.test.d.ts', '**/*.spec.d.ts', '**/internal/**', '**/dev-types/**'],
    }),
  ],
};
```

## 🤝 Contributing

Contributions are welcome! Please feel free to submit a Pull Request. (◕‿◕)

### Development Setup

```bash
# Clone the repository
git clone https://github.com/KasukabeTsumugi/rollup-plugin-dts-merger.git

# Install dependencies
pnpm install

# Run tests
pnpm test

# Build the project
pnpm build

# Lint code
pnpm lint
```

### Scripts

- `pnpm build` - Build the plugin
- `pnpm dev` - Build in watch mode
- `pnpm test` - Run tests
- `pnpm test:watch` - Run tests in watch mode
- `pnpm test:coverage` - Run tests with coverage
- `pnpm lint` - Lint code
- `pnpm lint:fix` - Fix linting issues

## 📄 License

MIT © [KasukabeTsumugi](mailto:futami16237@gmail.com)

---

Made with ❤️ by [KasukabeTsumugi](https://github.com/KasukabeTsumugi) ✨
